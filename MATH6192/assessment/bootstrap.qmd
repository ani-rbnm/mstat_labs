---
title: bootstrap
date: 2026/12/08
format: html
---

* Initial preparation


```{r}
library(ggplot2)
library(readr)
set.seed(42)

boot_df <- read.csv("boot_data.csv", header = T)
head(boot_df)
```

##### Q1. Creating function to estimate `w`


```{r}
get_wth <- function(data) {
  w_tilde_hat <- ( var(data$y) - cov(data$x, data$y)) /
  (var(data$x) + var(data$y) - 2 * cov(data$x, data$y))

  w_tilde_hat
} 
```
##### Q2. Function to get a single bootstap sample


```{r}
get_BS_sample <- function(data) {
  n <- nrow(data)
  data[sample(seq_len(n), n, replace = T),]
} 
```
##### Q3. Write a function that generates B bootstrap samples and for each calculates w_tilde_hat

```{r}
get_wth_samples <- function(data, B) {
  w_ths <- numeric(length = B)
  for (i in seq_len(B)) {
    w_ths[i] <- get_wth(get_BS_sample(data))
  }
  w_ths
}
```
* plotting histogram and density plots for the estimates theta_tilde_hats


```{r}
B <- 1000
w_ths <- get_wth_samples(boot_df, B)

ggplot(as.data.frame( w_ths ),
  aes(x = w_ths)
) +
geom_histogram(color = "black", fill = "white") +
  geom_density(alpha = 0.2, fill = "#FF6666")
```

##### Q4. Calculating standard error and CI


```{r}

w_ths_se <- sqrt(1 / (B - 1) * sum((w_ths - mean(w_ths))^2))
alpha <- 0.025
pcentile_ci <- quantile(w_ths, probs = c(alpha, 1 - alpha))
sd(w_ths)
pct_ci_w <- pcentile_ci[2] - pcentile_ci[1]
```
standard error: `r w_ths_se`

95% CI (percentile method): `r pcentile_ci`

Width of 95% CI(percentile method): `r pct_ci_w`

